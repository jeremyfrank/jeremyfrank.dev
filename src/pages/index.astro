---
import { getCollection } from 'astro:content'

import BaseLayout from '../layouts/BaseLayout.astro'
import Intro from '../components/Intro.astro'
import WorkCard from '../components/WorkCard.astro'
import Clients from '../components/Clients.astro'

const allWork = (await getCollection('work')).sort(
  (a, b) => new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf(),
)

const featuredWork = allWork.filter((item) => item.data.featured)
const remainingWork = allWork.filter((item) => !item.data.featured)
---

<BaseLayout>
  <Intro />

  <section class="my-20 px-5 sm:px-8 md:px-12 lg:px-16 xl:px-0">
    <div
      class="flex flex-col gap-12 items-center justify-center max-w-5xl mx-auto"
    >
      <h2>Work</h2>

      <ul
        class:list={[
          'grid gap-12',
          'sm:grid-cols-2',
          'sm:gap-8',
          'md:gap-12',
          'lg:gap-16',
          'xl:gap-20',
        ]}
      >
        {
          featuredWork.map((item) => (
            <WorkCard
              title={item.data.title}
              url={`work/${item.slug}`}
              cardImage={item.data.cardImage}
              color={item.data.color}
              summary={item.data.summary}
              extended={true}
            />
          ))
        }
      </ul>

      <details class="flex flex-col w-full">
        <summary
          class="cursor-pointer select-none text-center mx-auto w-[10ch]"
        >
          More
        </summary>

        <ul
          class="mt-10 grid grid-cols-2 gap-5 sm:grid-cols-3 md:grid-cols-5 sm:gap-5"
        >
          {
            remainingWork.map((item) => (
              <WorkCard
                title={item.data.title}
                url={`work/${item.slug}`}
                cardImage={item.data.cardImage}
                color={item.data.color}
              />
            ))
          }
        </ul>
      </details>
    </div>
  </section>

  <Clients />
</BaseLayout>
